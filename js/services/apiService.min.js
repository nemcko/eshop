define(["services/services"],function(l){l.factory("ApiSvc",["$http","$modal","$state","$timeout","$sce","tools",function(m,l,k,n,p,f){return{newId:function(){return(new Date).getTime().toString()},removeDiacritic:function(c,a){var b="\u00e1\u00e4\u010d\u010f\u00e9\u011b\u00ed\u013e\u013a\u0148\u00f3\u00f4\u00f4\u00f6\u0159\u0155\u0161\u0165\u00fa\u016f\u00fc\u00fd\u0159\u017e\u00c1\u00c4\u010c\u010e\u00c9\u011a\u00cd\u013d\u0139\u0147\u00d3\u00d4\u00d6\u0158\u0160\u0164\u00da\u00dc\u00dd\u0158\u017d",
e="aacdeeillnoooorrstuuuyrzAACDEEILLNOOORSTUUYRZ",d="";void 0===a&&(b+=" +=*/",e+="_____");for(var h=0;h<c.length;h++){for(var f=!1,g=0;g<b.length;g++)if(c[h]==b[g]){d+=e[g];f=!0;break}f||(d+=c[h])}return d},getNumber:function(c,a){var b="",e=0;if(c){for(c=c.toString();e<c.length;){var d=c.charAt(e++);if(void 0===a)0==d%1&&(b+=d);else if(0==d%1||d===a)b+=d}return parseFloat(b)}return 0},checkInputErrors:function(c,a){void 0===a&&(a="");for(var b in c["checkInputErrors"+a])if(c["checkInputErrors"+
a][b])return n(function(){jQuery("#"+b.replaceAll(".","_")).focus();jQuery("#"+b.replaceAll(".","_")).select()},100),!1;return!0},setInputError:function(c,a,b){jQuery("#err_"+a.replaceAll(".","_")).html(b);c.checkInputErrors[a]=!0;jQuery("#err_"+a.replaceAll(".","_")).removeClass("ng-hide");n(function(){jQuery("#"+a.replaceAll(".","_")).focus();jQuery("#"+a.replaceAll(".","_")).select()},100)},encodeData:function(c,a){var b,e=CryptoJS.enc.Latin1.parse(CryptoJS.MD5(a).toString().substr(0,24)),d=CryptoJS.enc.Latin1.parse(CryptoJS.MD5(a).toString().substr(0,
8));try{b=CryptoJS.enc.Base64.stringify(CryptoJS.TripleDES.encrypt(angular.toJson(c),e,{iv:d}).ciphertext)}catch(f){b=null}return b},decodeData:function(c,a){var b,e=CryptoJS.enc.Latin1.parse(CryptoJS.MD5(a).toString().substr(0,24)),d=CryptoJS.enc.Latin1.parse(CryptoJS.MD5(a).toString().substr(0,8));try{b=angular.fromJson(CryptoJS.enc.Utf8.stringify(CryptoJS.TripleDES.decrypt(c,e,{iv:d})))}catch(f){b=null}return b},getData:function(c,a,b,e){jQuery("*").css("cursor","progress");if(null==b||void 0===
b){var d=!1;if(window.XMLHttpRequest)d=new XMLHttpRequest;else if(window.ActiveXObject)try{d=new ActiveXObject("Msxml2.XMLHTTP")}catch(h){try{d=new ActiveXObject("Microsoft.XMLHTTP")}catch(k){}}if(!d)return f.MsgBox("Error","XMLHTTP error","exclamation-sign"),jQuery("*").css("cursor","default"),null;c="api/?/"+c;null!==a&&void 0!==a&&(c=c+"&"+$.param(a));d.open("GET",c,!1);d.setRequestHeader("Accept","application/json");d.send(null);if(200===d.status)try{var g=angular.fromJson(d.responseText);if(200==
g.status)return jQuery("*").css("cursor","default"),angular.fromJson(g.data)}catch(l){}jQuery("*").css("cursor","default");return null}m({method:"GET",responseType:"json",url:"api/?/"+c,params:a}).success(function(a){jQuery("*").css("cursor","default");void 0!==b&&a&&b(angular.fromJson(a.data))}).error(function(a){jQuery("*").css("cursor","default");if(void 0===e||e)"object"===typeof a?f.MsgBox("Error",a.message,"exclamation-sign"):f.MsgBox("Error",a,"exclamation-sign")})},setData:function(c,a,b,
e,d){jQuery("*").css("cursor","progress");null!==a&&void 0!==a&&null!==b&&(b=this.encodeData(b,a));if(null==e||void 0===e){a=!1;if(window.XMLHttpRequest)a=new XMLHttpRequest;else if(window.ActiveXObject)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(h){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(k){}}if(!a)return f.MsgBox("Error","XMLHTTP error","exclamation-sign"),jQuery("*").css("cursor","default"),null;a.open("POST","api/?/"+c,!1);a.setRequestHeader("Accept","application/json");a.send(b);
if(200===a.status)try{var g=angular.fromJson(a.responseText);if(200==g.status)return jQuery("*").css("cursor","default"),angular.fromJson(g.data)}catch(l){}jQuery("*").css("cursor","default");return null}m({method:"POST",responseType:"json",url:"api/?/"+c,data:b}).success(function(a){jQuery("*").css("cursor","default");"function"===typeof e&&a&&e(angular.fromJson(a.data))}).error(function(a){jQuery("*").css("cursor","default");if(void 0===d||d)"object"===typeof a?f.MsgBox("Error",a.message,"exclamation-sign"):
f.MsgBox("Error",a,"exclamation-sign")})},goToState:function(c,a){void 0===a?k.transitionTo(c):"boolean"==typeof a?void 0!==$scope.parentobj.id&&k.transitionTo(c,{id:$scope.parentobj.id}):k.transitionTo(c,{id:a})}}}])});
