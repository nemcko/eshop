define(['directives/directives'], function(directives) {
	directives.directive('loadimage', ['$rootScope', function($rootScope) {
		return {
			restrict: 'A',
			replace:true,
			scope: {
				loadimage: '@',
				cls: '@',
				datafld: '=datafld'
			},
			link: function (scope, element,attrs) {				
				var match = (''+scope.loadimage).match(/{{.*}}/);
				if ( !match ) {
					scope.Img = new Image();
					jQuery(scope.Img).load(function() {
						jQuery(element).attr("src",scope.Img.src);
					});
					scope.Img.src = "api/service/image.php?img="+scope.loadimage;
				}

//				if ( attrs.datafld ===undefined ) {
//					scope.Img = new Image();
//					jQuery(scope.Img).load(function() {
//						jQuery(element).attr("src",scope.Img.src);
//					});
//					scope.Img.src = "api/service/image.php?img="+scope.loadimage;
//				} else {
//					scope.$watch(attrs.datafld, function (newSrc, oldSrc,scope) {
//						scope.Img = new Image();
//						jQuery(scope.Img).load(function() {
//							jQuery(element).attr("src",scope.Img.src);
//						});
//						if ( newSrc===undefined ) {
//							scope.Img.src = "api/service/image.php?img="+scope.loadimage;
//						} else {
//							scope.Img.src = "api/service/image.php?img="+newSrc;
//						}
//					});
//				}
			},
			template: '<img id="i{{cls}}{{loadimage}}" class="{{cls}}" src="data:image/png;base64,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" />'
		};
	}]);
});